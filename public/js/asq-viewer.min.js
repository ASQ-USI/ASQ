/*! ASQ 2013-09-11 */
require=function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({"1vITL1":[function(require,module){var global=self;!function(module,exports,define,browserify_shim__define__module__export__){!function(document,window){"use strict";var pfx=function(){var style=document.createElement("dummy").style,prefixes="Webkit Moz O ms Khtml".split(" "),memory={};return function(prop){if("undefined"==typeof memory[prop]){var ucProp=prop.charAt(0).toUpperCase()+prop.substr(1),props=(prop+" "+prefixes.join(ucProp+" ")+ucProp).split(" ");memory[prop]=null;for(var i in props)if(void 0!==style[props[i]]){memory[prop]=props[i];break}}return memory[prop]}}(),arrayify=function(a){return[].slice.call(a)},css=function(el,props){var key,pkey;for(key in props)props.hasOwnProperty(key)&&(pkey=pfx(key),null!==pkey&&(el.style[pkey]=props[key]));return el},toNumber=function(numeric,fallback){return isNaN(numeric)?fallback||0:Number(numeric)},byId=function(id){return document.getElementById(id)},$=function(selector,context){return context=context||document,context.querySelector(selector)},$$=function(selector,context){return context=context||document,arrayify(context.querySelectorAll(selector))},triggerEvent=function(el,eventName,detail){var event=document.createEvent("CustomEvent");event.initCustomEvent(eventName,!0,!0,detail),el.dispatchEvent(event)},translate=function(t){return" translate3d("+t.x+"px,"+t.y+"px,"+t.z+"px) "},rotate=function(r,revert){var rX=" rotateX("+r.x+"deg) ",rY=" rotateY("+r.y+"deg) ",rZ=" rotateZ("+r.z+"deg) ";return revert?rZ+rY+rX:rX+rY+rZ},scale=function(s){return" scale("+s+") "},perspective=function(p){return" perspective("+p+"px) "},computeWindowScale=function(config){var hScale=window.innerHeight/config.height,wScale=window.innerWidth/config.width,scale=hScale>wScale?wScale:hScale;return config.maxScale&&scale>config.maxScale&&(scale=config.maxScale),config.minScale&&scale<config.minScale&&(scale=config.minScale),scale},body=document.body;navigator.userAgent.toLowerCase();var impressSupported=null!==pfx("perspective")&&body.classList&&body.dataset;impressSupported?(body.classList.remove("impress-not-supported"),body.classList.add("impress-supported")):body.className+=" impress-not-supported ";var roots={},defaults={width:1024,height:768,maxScale:1,minScale:0,perspective:1e3,transitionDuration:1e3},empty=function(){return!1},impress=window.impress=function(rootId){if(!impressSupported)return{init:empty,"goto":empty,gotoSub:empty,prev:empty,next:empty};if(rootId=rootId||"impress",roots["impress-root-"+rootId])return roots["impress-root-"+rootId];var stepsData={},activeStep=null,currentState=null,steps=null,config=null,windowScale=null,root=byId(rootId),canvas=document.createElement("div"),initialized=!1,lastEntered=null,onStepEnter=function(step){lastEntered!==step&&(triggerEvent(step,"impress:stepenter"),lastEntered=step)},onStepLeave=function(step){lastEntered===step&&(triggerEvent(step,"impress:stepleave"),lastEntered=null)},initStep=function(el,idx){var data=el.dataset,step={translate:{x:toNumber(data.x),y:toNumber(data.y),z:toNumber(data.z)},rotate:{x:toNumber(data.rotateX),y:toNumber(data.rotateY),z:toNumber(data.rotateZ||data.rotate)},scale:toNumber(data.scale,1),el:el};el.id||(el.id="step-"+(idx+1)),stepsData["impress-"+el.id]=step,css(el,{position:"absolute",transform:"translate(-50%,-50%)"+translate(step.translate)+rotate(step.rotate)+scale(step.scale),transformStyle:"preserve-3d"})},init=function(){if(!initialized){var meta=$("meta[name='viewport']")||document.createElement("meta");meta.content="width=device-width, minimum-scale=1, maximum-scale=1, user-scalable=no",meta.parentNode!==document.head&&(meta.name="viewport",document.head.appendChild(meta));var rootData=root.dataset;config={width:toNumber(rootData.width,defaults.width),height:toNumber(rootData.height,defaults.height),maxScale:toNumber(rootData.maxScale,defaults.maxScale),minScale:toNumber(rootData.minScale,defaults.minScale),perspective:toNumber(rootData.perspective,defaults.perspective),transitionDuration:toNumber(rootData.transitionDuration,defaults.transitionDuration)},windowScale=computeWindowScale(config),arrayify(root.childNodes).forEach(function(el){canvas.appendChild(el)}),root.appendChild(canvas),document.documentElement.style.height="100%",css(body,{height:"100%",overflow:"hidden"});var rootStyles={position:"absolute",transformOrigin:"top left",transition:"all 0s ease-in-out",transformStyle:"preserve-3d"};css(root,rootStyles),css(root,{top:"50%",left:"50%",transform:perspective(config.perspective/windowScale)+scale(windowScale)}),css(canvas,rootStyles),body.classList.remove("impress-disabled"),body.classList.add("impress-enabled"),steps=$$(".step",root),steps.forEach(initStep),currentState={translate:{x:0,y:0,z:0},rotate:{x:0,y:0,z:0},scale:1},initialized=!0,triggerEvent(root,"impress:init",{api:roots["impress-root-"+rootId]})}},getStep=function(step){return"number"==typeof step?step=0>step?steps[steps.length+step]:steps[step]:"string"==typeof step&&(step=byId(step)),step&&step.id&&stepsData["impress-"+step.id]?step:null},stepEnterTimeout=null,goto=function(el,duration){if(!initialized||!(el=getStep(el)))return!1;window.scrollTo(0,0);var step=stepsData["impress-"+el.id];activeStep&&(activeStep.classList.remove("active"),body.classList.remove("impress-on-"+activeStep.id)),el.classList.add("active"),body.classList.add("impress-on-"+el.id);var target={rotate:{x:-step.rotate.x,y:-step.rotate.y,z:-step.rotate.z},translate:{x:-step.translate.x,y:-step.translate.y,z:-step.translate.z},scale:1/step.scale},zoomin=target.scale>=currentState.scale;duration=toNumber(duration,config.transitionDuration);var delay=duration/2;el===activeStep&&(windowScale=computeWindowScale(config));var targetScale=target.scale*windowScale;return activeStep&&activeStep!==el&&onStepLeave(activeStep),css(root,{transform:perspective(config.perspective/targetScale)+scale(targetScale),transitionDuration:duration+"ms",transitionDelay:(zoomin?delay:0)+"ms"}),css(canvas,{transform:rotate(target.rotate,!0)+translate(target.translate),transitionDuration:duration+"ms",transitionDelay:(zoomin?0:delay)+"ms"}),(currentState.scale===target.scale||currentState.rotate.x===target.rotate.x&&currentState.rotate.y===target.rotate.y&&currentState.rotate.z===target.rotate.z&&currentState.translate.x===target.translate.x&&currentState.translate.y===target.translate.y&&currentState.translate.z===target.translate.z)&&(delay=0),currentState=target,activeStep=el,window.clearTimeout(stepEnterTimeout),stepEnterTimeout=window.setTimeout(function(){onStepEnter(activeStep)},duration+delay),el},forEach=Array.prototype.forEach,slice=Array.prototype.slice,isArray=Array.isArray,setPrevious=function(data){return isArray(data)?(data.forEach(setPrevious),void 0):(data.classList.remove("active"),data.classList.add("previous"),void 0)},setActive=function(data){return isArray(data)?(data.forEach(setActive),void 0):(data.classList.remove("previous"),data.classList.add("active"),void 0)},clearSub=function(data){return isArray(data)?(data.forEach(clearSub),void 0):(data.classList.remove("active"),data.classList.remove("previous"),void 0)},gotoSub=function(index){var subSteps,active=activeStep;active.subSteps||setSubSteps(active),subSteps=active.subSteps,null===index&&(prev=steps.indexOf(active)-1,prev=prev>=0?steps[prev]:steps[steps.length-1],prev.subSteps||setSubSteps(prev),prev.subSteps.length&&prev.subSteps.active!==prev.subSteps.length-1&&(slice.call(prev.subSteps,0,-1).forEach(setPrevious),setActive(prev.subSteps[prev.subSteps.length-1]),prev.subSteps.active=prev.subSteps.length-1)),subSteps.length&&index>=0&&index<=subSteps.length-1&&(index&&slice.call(subSteps,0,index).forEach(setPrevious),index<subSteps.length-1&&slice.call(subSteps,index).forEach(clearSub),index==subSteps.length-1&&(next=steps.indexOf(active)+1,next=next<steps.length?steps[next]:steps[0],next.subSteps||setSubSteps(next),null!=next.subSteps.active&&(forEach.call(next.subSteps,clearSub),next.subSteps.active=null)),null!=index&&setActive(subSteps[index]),subSteps.active=index)},next=function(){var subactive,next,subSteps,active=activeStep;return active.subSteps||setSubSteps(active),subSteps=active.subSteps,subSteps.length&&(subactive=subSteps.active)!==subSteps.length-1?(isNaN(subactive)&&(subactive=-1),gotoSub(++subactive)):(next=steps.indexOf(active)+1,next=next<steps.length?steps[next]:steps[0],goto(next))},prev=function(){var subactive,subSteps,active=activeStep;return active.subSteps||setSubSteps(active),subSteps=active.subSteps,subSteps.length&&((subactive=subSteps.active)||0===subactive)?(subactive?--subactive:subactive=null,gotoSub(subactive)):(prev=steps.indexOf(active)-1,prev=prev>=0?steps[prev]:steps[steps.length-1],goto(prev))},setSubSteps=function(el){var steps=el.querySelectorAll(".substep"),order=[],unordered=[];forEach.call(steps,function(el){if(el.dataset){var index=Number(el.dataset.order);isNaN(index)?unordered.push(el):order[index]?Array.isArray(order[index])?order[index].push(el):order[index]=[order[index],el]:order[index]=el}else unordered.push(el)}),el.subSteps=order.filter(Boolean).concat(unordered)};return root.addEventListener("impress:init",function(){steps.forEach(function(step){step.classList.add("future")}),root.addEventListener("impress:stepenter",function(event){event.target.classList.remove("past"),event.target.classList.remove("future"),event.target.classList.add("present")},!1),root.addEventListener("impress:stepleave",function(event){event.target.classList.remove("present"),event.target.classList.add("past")},!1)},!1),root.addEventListener("impress:init",function(){var lastHash="";root.addEventListener("impress:stepenter",function(event){window.location.hash=lastHash="#/"+event.target.id},!1),goto(steps[0],0)},!1),body.classList.add("impress-disabled"),roots["impress-root-"+rootId]={init:init,"goto":goto,gotoSub:gotoSub,next:next,prev:prev}};impress.supported=impressSupported}(document,window),function(document,window){"use strict";var throttle=function(fn,delay){var timer=null;return function(){var context=this,args=arguments;clearTimeout(timer),timer=setTimeout(function(){fn.apply(context,args)},delay)}};document.addEventListener("impress:init",function(event){var api=event.detail.api;window.addEventListener("resize",throttle(function(){api.goto(document.querySelector(".active"),500)},250),!1)},!1)}(document,window),browserify_shim__define__module__export__("undefined"!=typeof impress?impress:window.impress)}.call(global,void 0,void 0,void 0,function(ex){module.exports=ex})},{}],impressAdmin:[function(require,module){module.exports=require("1vITL1")},{}],3:[function(){function drawChart(){$(".stats").each(function(){var questionId=$(this).data("target-assessment-id");statsTypes.rightVsWrong.chart[questionId]=new google.visualization.PieChart($(this).find(".rvswChart")[0]),statsTypes.distinctOptions.chart[questionId]=new google.visualization.ColumnChart($(this).find(".distinctOptions")[0]),statsTypes.distinctAnswers.chart[questionId]=new google.visualization.ColumnChart($(this).find(".distinctAnswers")[0])})}function requestStats(questionId,obj){$.getJSON("/stats/getStats?question="+questionId+"&metric="+obj.metric,function(data){obj.data[questionId]=google.visualization.arrayToDataTable(data),obj.chart[questionId].draw(obj.data[questionId],obj.options)})}var socket,session;$(function(){$(document).on("click",".changeAnswer",function(event){event.preventDefault();var $this=$(this).parents("form");$(this).parent().parent().find('input[type="hidden"][name="question-id"]').val();var resubmitEvent=new CustomEvent("local:resubmit",{});document.dispatchEvent(resubmitEvent),$this.children().css("opacity","1").end().find("input").removeAttr("disabled").end().find(".changeAnswer").fadeOut(function(){$(this).remove(),$this.find("button").removeAttr("disabled").fadeIn()})}),$(document).on("submit",".assessment form",function(event){event.preventDefault();var $this=$(this),questionId=$this.find('input[type="hidden"][name="question-id"]').val();console.log("QuestionID= "+questionId),$this.children().css("opacity","0.5").end().find("input").attr("disabled","true").end().find("button:not(.changeanswer .btn)").attr("disabled","true").fadeOut(function(){$this.append('<div class="changeAnswer" style="display: none"><p><button class="btn btn-primary">Modify answer</button>&nbsp; &nbsp; <span class="muted"> ✔ Your answer has been submitted.<span></p></div>'),$this.find(".changeAnswer").fadeIn()});var questionId=$(this).find('input[type="hidden"][name="question-id"]').val(),answers=[];$(this).find("input[type=checkbox], input[type=radio]").each(function(){answers.push($(this).is(":checked"))}),$(this).find("input[type=text]").each(function(){answers.push($(this).val())}),socket.emit("asq:submit",{session:session,answers:answers,questionId:questionId}),console.log("submitted answer for question with id:"+questionId)})}),google.load("visualization","1",{packages:["corechart"]}),google.setOnLoadCallback(drawChart);var statsTypes={rightVsWrong:{metric:"rightVsWrong",data:[],chart:[],options:{width:800}},distinctOptions:{metric:"distinctOptions",data:[],chart:[],options:{title:"How often was a group of options selected",width:800,isStacked:!0,legend:{position:"top",alignment:"center"}}},distinctAnswers:{metric:"distinctAnswers",data:[],chart:[],options:{title:"How often was an option selected",isStacked:!0,width:800,legend:{position:"top",alignment:"center"}}}};$('a[data-toggle="tab"]').on("shown",function(){var questionId=$(this).parents().find(".stats").data("target-assessment-id");for(var key in statsTypes)requestStats(questionId,statsTypes[key])})},{}]},{},[3]);